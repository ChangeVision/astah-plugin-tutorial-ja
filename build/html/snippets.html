
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>astah* Plug-in 用スニペット集 &#8212; astah* Plug-in 開発チュートリアル 1.2 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="astah* Plug-in SDK コマンド一覧" href="appendixB.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="appendixB.html" title="astah* Plug-in SDK コマンド一覧"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">astah* Plug-in 開発チュートリアル 1.2 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">astah* Plug-in 用スニペット集</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="astah-plug-in">
<h1>astah* Plug-in 用スニペット集<a class="headerlink" href="#astah-plug-in" title="Permalink to this headline">¶</a></h1>
<div class="section" id="astah-api">
<h2>astah* API用ユーティリティ<a class="headerlink" href="#astah-api" title="Permalink to this headline">¶</a></h2>
<p>astah* のモデルを操作する際に便利なメソッド群</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * パッケージ名は、生成したプラグインのパッケージ名よりも下に移してください。</span>
<span class="cm"> * プラグインのパッケージ名=&gt; com.example</span>
<span class="cm"> *   com.change_vision.astah.extension.plugin =&gt; X</span>
<span class="cm"> *   com.example                              =&gt; O</span>
<span class="cm"> *   com.example.internal                     =&gt; O</span>
<span class="cm"> *   learning                                 =&gt; X</span>
<span class="cm"> */</span>
<span class="kn">package</span> <span class="nn">com.example.internal</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.exception.InvalidEditingException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.model.IAttribute</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.model.IClass</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.model.IClassifierTemplateParameter</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.model.IElement</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.model.IGeneralization</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.model.INamedElement</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.model.IOperation</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.model.IPackage</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.model.IParameter</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.model.IRealization</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AstahUtils</span> <span class="p">{</span>

  <span class="cm">/**</span>
<span class="cm">   * 対象が所有しているクラスを取得します。</span>
<span class="cm">   *</span>
<span class="cm">   * @param owner クラス または パッケージ</span>
<span class="cm">   * @return クラスの場合はネストしているクラス群</span>
<span class="cm">   *         パッケージの場合はパッケージにあるクラス群</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="n">IClass</span><span class="o">[]</span> <span class="nf">getOwnedClasses</span><span class="p">(</span><span class="n">Object</span> <span class="n">owner</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">owner</span> <span class="k">instanceof</span> <span class="n">IClass</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">((</span><span class="n">IClass</span><span class="p">)</span> <span class="n">owner</span><span class="p">).</span><span class="na">getNestedClasses</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">owner</span> <span class="k">instanceof</span> <span class="n">IPackage</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">List</span><span class="o">&lt;</span><span class="n">IClass</span><span class="o">&gt;</span> <span class="n">classes</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">IClass</span><span class="o">&gt;</span><span class="p">();</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">INamedElement</span> <span class="n">element</span> <span class="p">:</span> <span class="p">((</span><span class="n">IPackage</span><span class="p">)</span> <span class="n">owner</span><span class="p">).</span><span class="na">getOwnedElements</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">element</span> <span class="k">instanceof</span> <span class="n">IClass</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">classes</span><span class="p">.</span><span class="na">add</span><span class="p">((</span><span class="n">IClass</span><span class="p">)</span> <span class="n">element</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="n">classes</span><span class="p">.</span><span class="na">toArray</span><span class="p">(</span><span class="k">new</span> <span class="n">IClass</span><span class="o">[</span><span class="n">classes</span><span class="p">.</span><span class="na">size</span><span class="p">()</span><span class="o">]</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">new</span> <span class="n">IClass</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="cm">/**</span>
<span class="cm">   * 対象が所有しているクラスのうち、名前を指定して取得します。</span>
<span class="cm">   *</span>
<span class="cm">   * @param owner クラス または パッケージ</span>
<span class="cm">   * @param name  名前</span>
<span class="cm">   * @return クラスの場合はネストしているクラスのうち、同名のもの</span>
<span class="cm">   *         パッケージの場合はパッケージにあるクラスのうち、同名のもの</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="n">IClass</span> <span class="nf">getOwnedClass</span><span class="p">(</span><span class="n">Object</span> <span class="n">owner</span><span class="p">,</span> <span class="n">String</span> <span class="n">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">owner</span> <span class="k">instanceof</span> <span class="n">IClass</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">getNestedClass</span><span class="p">((</span><span class="n">IClass</span><span class="p">)</span> <span class="n">owner</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">owner</span> <span class="k">instanceof</span> <span class="n">IPackage</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">getOwnedElement</span><span class="p">((</span><span class="n">IPackage</span><span class="p">)</span> <span class="n">owner</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">IClass</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>


  <span class="cm">/**</span>
<span class="cm">   * 対象のパッケージが所有しているINamedElementから、名前を指定して取得します。</span>
<span class="cm">   *</span>
<span class="cm">   * @param owner パッケージ</span>
<span class="cm">   * @param name  名前</span>
<span class="cm">   * @return 該当するINamedElement</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="n">INamedElement</span> <span class="nf">getOwnedElement</span><span class="p">(</span><span class="n">IPackage</span> <span class="n">owner</span><span class="p">,</span> <span class="n">String</span> <span class="n">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">getOwnedElement</span><span class="p">(</span><span class="n">owner</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">INamedElement</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="cm">/**</span>
<span class="cm">   * 対象のパッケージが所有しているオブジェクトから、名前と型を指定して取得します。</span>
<span class="cm">   *</span>
<span class="cm">   * @param owner       パッケージ</span>
<span class="cm">   * @param name        名前</span>
<span class="cm">   * @param elementType INamedElementの子クラス型</span>
<span class="cm">   * @return 該当するINamedElementの子クラス型</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">INamedElement</span><span class="o">&gt;</span> <span class="n">T</span> <span class="nf">getOwnedElement</span><span class="p">(</span><span class="n">IPackage</span> <span class="n">owner</span><span class="p">,</span>
      <span class="n">String</span> <span class="n">name</span><span class="p">,</span> <span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">elementType</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">INamedElement</span> <span class="n">element</span> <span class="p">:</span> <span class="n">owner</span><span class="p">.</span><span class="na">getOwnedElements</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">element</span><span class="p">.</span><span class="na">getName</span><span class="p">()))</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">elementType</span><span class="p">.</span><span class="na">isInstance</span><span class="p">(</span><span class="n">element</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">return</span> <span class="n">elementType</span><span class="p">.</span><span class="na">cast</span><span class="p">(</span><span class="n">element</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="cm">/**</span>
<span class="cm">   * 対象のクラスが所有しているネストクラスから、名前を指定して取得します。</span>
<span class="cm">   *</span>
<span class="cm">   * @param owner クラス</span>
<span class="cm">   * @param name  名前</span>
<span class="cm">   * @return 該当するネストクラス</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="n">IClass</span> <span class="nf">getNestedClass</span><span class="p">(</span><span class="n">IClass</span> <span class="n">owner</span><span class="p">,</span> <span class="n">String</span> <span class="n">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">IClass</span> <span class="n">element</span> <span class="p">:</span> <span class="n">owner</span><span class="p">.</span><span class="na">getNestedClasses</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">element</span><span class="p">.</span><span class="na">getName</span><span class="p">()))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">element</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="cm">/**</span>
<span class="cm">   * 対象のクラスと指定した親クラスの汎化を取得します。</span>
<span class="cm">   *</span>
<span class="cm">   * @param owner     クラス</span>
<span class="cm">   * @param superType 親クラス</span>
<span class="cm">   * @return 汎化オブジェクト</span>
<span class="cm">   *         ただし、指定した親クラスが対象のクラスの親でない場合は、nullを返す</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="n">IGeneralization</span> <span class="nf">getGeneralization</span><span class="p">(</span><span class="n">IClass</span> <span class="n">owner</span><span class="p">,</span>
      <span class="n">IClass</span> <span class="n">superType</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">IGeneralization</span> <span class="n">generalization</span> <span class="p">:</span> <span class="n">owner</span><span class="p">.</span><span class="na">getGeneralizations</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">superType</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">generalization</span><span class="p">.</span><span class="na">getSuperType</span><span class="p">()))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">generalization</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="cm">/**</span>
<span class="cm">   * 対象のクラスと指定した子クラスの汎化を取得します。</span>
<span class="cm">   *</span>
<span class="cm">   * @param owner   クラス</span>
<span class="cm">   * @param subType 子クラス</span>
<span class="cm">   * @return 汎化オブジェクト</span>
<span class="cm">   *         ただし、指定した子クラスが対象のクラスの子でない場合は、nullを返す</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="n">IGeneralization</span> <span class="nf">getSpecialization</span><span class="p">(</span><span class="n">IClass</span> <span class="n">owner</span><span class="p">,</span> <span class="n">IClass</span> <span class="n">subType</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">IGeneralization</span> <span class="n">generalization</span> <span class="p">:</span> <span class="n">owner</span><span class="p">.</span><span class="na">getSpecializations</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">subType</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">generalization</span><span class="p">.</span><span class="na">getSubType</span><span class="p">()))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">generalization</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="cm">/**</span>
<span class="cm">   * 対象のクラスと指定した実現先クラスの実現を取得します。</span>
<span class="cm">   *</span>
<span class="cm">   * @param owner    対象のクラス</span>
<span class="cm">   * @param supplier 実現先</span>
<span class="cm">   *</span>
<span class="cm">   * @return 実現</span>
<span class="cm">   *         ただし、指定した実現先クラスが対象のクラスの実現先でない場合は、nullを返す</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="n">IRealization</span> <span class="nf">getClientRealization</span><span class="p">(</span><span class="n">IClass</span> <span class="n">owner</span><span class="p">,</span>
      <span class="n">IClass</span> <span class="n">supplier</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">IRealization</span> <span class="n">realization</span> <span class="p">:</span> <span class="n">owner</span><span class="p">.</span><span class="na">getClientRealizations</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">supplier</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">realization</span><span class="p">.</span><span class="na">getSupplier</span><span class="p">()))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">realization</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="cm">/**</span>
<span class="cm">   * 対象のクラスと指定した実現元クラスの実現を取得します。</span>
<span class="cm">   *</span>
<span class="cm">   * @param owner    対象のクラス</span>
<span class="cm">   * @param client   実現元</span>
<span class="cm">   *</span>
<span class="cm">   * @return 実現</span>
<span class="cm">   *         ただし、指定した実現元クラスが対象のクラスの実現元でない場合は、nullを返す</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="n">IRealization</span> <span class="nf">getSupplierRealization</span><span class="p">(</span><span class="n">IClass</span> <span class="n">owner</span><span class="p">,</span>
      <span class="n">IClass</span> <span class="n">client</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">IRealization</span> <span class="n">realization</span> <span class="p">:</span> <span class="n">owner</span><span class="p">.</span><span class="na">getSupplierRealizations</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">client</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">realization</span><span class="p">.</span><span class="na">getClient</span><span class="p">()))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">realization</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>


  <span class="cm">/**</span>
<span class="cm">   * 対象クラスから指定した名前のテンプレートパラメータを取得します。</span>
<span class="cm">   *</span>
<span class="cm">   * @param owner  対象のクラス</span>
<span class="cm">   * @param name   パラメータ名</span>
<span class="cm">   * @return テンプレートパラメータ</span>
<span class="cm">   *         該当の名前のテンプレートパラメータが存在しない場合はnullが返ります。</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="n">IClassifierTemplateParameter</span> <span class="nf">getTemplateParameter</span><span class="p">(</span>
      <span class="n">IClass</span> <span class="n">owner</span><span class="p">,</span> <span class="n">String</span> <span class="n">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">IClassifierTemplateParameter</span> <span class="n">templateParameter</span> <span class="p">:</span> <span class="n">owner</span>
        <span class="p">.</span><span class="na">getTemplateParameters</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">templateParameter</span><span class="p">.</span><span class="na">getName</span><span class="p">()))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">templateParameter</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="cm">/**</span>
<span class="cm">   * 対象のクラスから指定した名前の属性を取得します。</span>
<span class="cm">   *</span>
<span class="cm">   * @param owner 対象のクラス</span>
<span class="cm">   * @param name  属性名</span>
<span class="cm">   * @return 属性</span>
<span class="cm">   *         該当の名前の属性が存在しない場合はnullが返ります。</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="n">IAttribute</span> <span class="nf">getAttribute</span><span class="p">(</span><span class="n">IClass</span> <span class="n">owner</span><span class="p">,</span> <span class="n">String</span> <span class="n">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">IAttribute</span> <span class="n">attribute</span> <span class="p">:</span> <span class="n">owner</span><span class="p">.</span><span class="na">getAttributes</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">attribute</span><span class="p">.</span><span class="na">getName</span><span class="p">()))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">attribute</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="cm">/**</span>
<span class="cm">   * 対象のクラスから指定した名前の操作を取得します。</span>
<span class="cm">   *</span>
<span class="cm">   * @param owner 対象のクラス</span>
<span class="cm">   * @param name  操作名</span>
<span class="cm">   * @return 操作</span>
<span class="cm">   *         該当の名前の操作が存在しない場合はnullが返ります。</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="n">IOperation</span> <span class="nf">getOperation</span><span class="p">(</span><span class="n">IClass</span> <span class="n">owner</span><span class="p">,</span> <span class="n">String</span> <span class="n">name</span><span class="p">,</span>
      <span class="n">Object</span><span class="o">[]</span> <span class="n">parameterTypes</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">IOperation</span> <span class="n">operation</span> <span class="p">:</span> <span class="n">owner</span><span class="p">.</span><span class="na">getOperations</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">name</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">operation</span><span class="p">.</span><span class="na">getName</span><span class="p">()))</span> <span class="p">{</span>
        <span class="n">IParameter</span><span class="o">[]</span> <span class="n">parameters</span> <span class="o">=</span> <span class="n">operation</span><span class="p">.</span><span class="na">getParameters</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">matches</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">parameterTypes</span><span class="p">))</span> <span class="p">{</span>
          <span class="k">return</span> <span class="n">operation</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="cm">/**</span>
<span class="cm">   * 対象のクラスにインタフェースであるかどうかを設定します。</span>
<span class="cm">   *</span>
<span class="cm">   * @param type 対象のクラス</span>
<span class="cm">   * @param isInterfase インタフェースであるかどうか</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setInterface</span><span class="p">(</span><span class="n">IClass</span> <span class="n">type</span><span class="p">,</span> <span class="kt">boolean</span> <span class="n">isInterface</span><span class="p">)</span>
      <span class="kd">throws</span> <span class="n">InvalidEditingException</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">isInterface</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">addStereotype</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="s">&quot;interface&quot;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">type</span><span class="p">.</span><span class="na">removeStereotype</span><span class="p">(</span><span class="s">&quot;interface&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="cm">/**</span>
<span class="cm">   * 対象の要素にステレオタイプを追加します。</span>
<span class="cm">   * @param element 対象の要素</span>
<span class="cm">   * @param stereotype 追加するステレオタイプ</span>
<span class="cm">   * @return 追加できた場合はtrue</span>
<span class="cm">   *         既に該当するステレオタイプがある場合はfalse</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">addStereotype</span><span class="p">(</span><span class="n">IElement</span> <span class="n">element</span><span class="p">,</span> <span class="n">String</span> <span class="n">stereotype</span><span class="p">)</span>
      <span class="kd">throws</span> <span class="n">InvalidEditingException</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">String</span> <span class="n">exists</span> <span class="p">:</span> <span class="n">element</span><span class="p">.</span><span class="na">getStereotypes</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">stereotype</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">exists</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">element</span><span class="p">.</span><span class="na">addStereotype</span><span class="p">(</span><span class="n">stereotype</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">matches</span><span class="p">(</span><span class="n">IParameter</span><span class="o">[]</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">Object</span><span class="o">[]</span> <span class="n">parameterTypes</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">parameterTypes</span><span class="p">.</span><span class="na">length</span> <span class="o">!=</span> <span class="n">parameters</span><span class="p">.</span><span class="na">length</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">parameterTypes</span><span class="p">.</span><span class="na">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">Object</span> <span class="n">type</span> <span class="o">=</span> <span class="n">parameterTypes</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">type</span> <span class="k">instanceof</span> <span class="n">IClass</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">type</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">parameters</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="na">getType</span><span class="p">()))</span> <span class="p">{</span>
          <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">type</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">parameters</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="na">getTypeExpression</span><span class="p">()))</span> <span class="p">{</span>
          <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>astah* のAPIのハンドリングをまとめたメソッド群</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * パッケージ名は、生成したプラグインのパッケージ名よりも下に移してください。</span>
<span class="cm"> * プラグインのパッケージ名=&gt; com.example</span>
<span class="cm"> *   com.change_vision.astah.extension.plugin =&gt; X</span>
<span class="cm"> *   com.example                              =&gt; O</span>
<span class="cm"> *   com.example.internal                     =&gt; O</span>
<span class="cm"> *   learning                                 =&gt; X</span>
<span class="cm"> */</span>
<span class="kn">package</span> <span class="nn">com.example.internal</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.swing.JFrame</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.change_vision.astah.extension.plugin.util.exception.APIException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.AstahAPI</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.editor.BasicModelEditor</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.editor.ClassDiagramEditor</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.editor.IDiagramEditorFactory</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.editor.IModelEditorFactory</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.exception.InvalidEditingException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.exception.InvalidUsingException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.model.IClassDiagram</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.project.ProjectAccessor</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.view.IDiagramViewManager</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.view.IViewManager</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * astah* APIを扱いやすいように包んだユーティリティクラスです。</span>
<span class="cm"> * 利用時にインスタンスを作成してください。</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AstahAPIUtils</span> <span class="p">{</span>

  <span class="cm">/**</span>
<span class="cm">   * 図の表示領域を管理するマネージャを返却します。</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="n">IDiagramViewManager</span> <span class="nf">getDiagramViewManager</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">IViewManager</span> <span class="n">viewManager</span> <span class="o">=</span> <span class="n">getViewManager</span><span class="p">();</span>
    <span class="n">IDiagramViewManager</span> <span class="n">diagramViewManager</span> <span class="o">=</span> <span class="n">viewManager</span><span class="p">.</span><span class="na">getDiagramViewManager</span><span class="p">();</span>
    <span class="k">return</span> <span class="n">diagramViewManager</span><span class="p">;</span>
  <span class="p">}</span>


  <span class="cm">/**</span>
<span class="cm">   * クラス図上にあるモデルを編集するためのエディタを取得します。</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="n">ClassDiagramEditor</span> <span class="nf">getClassDiagramEditor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">getDiagramEditorFactory</span><span class="p">().</span><span class="na">getClassDiagramEditor</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InvalidUsingException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="n">APIException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="cm">/**</span>
<span class="cm">   * 各図に共通する基本的なモデルを編集するためのエディタを取得します。</span>
<span class="cm">   *</span>
<span class="cm">   * @return BasicModelEditor</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="n">BasicModelEditor</span> <span class="nf">getBasicModelEditor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">getModelEditorFactory</span><span class="p">().</span><span class="na">getBasicModelEditor</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">InvalidEditingException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="n">APIException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="cm">/**</span>
<span class="cm">   * astah*のプロジェクトを扱うためのProjectAccessorを取得します。</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="n">ProjectAccessor</span> <span class="nf">getProjectAccessor</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ProjectAccessor</span> <span class="n">projectAccessor</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="n">AstahAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="n">AstahAPI</span><span class="p">.</span><span class="na">getAstahAPI</span><span class="p">();</span>
      <span class="n">projectAccessor</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="na">getProjectAccessor</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">ClassNotFoundException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalStateException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">projectAccessor</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;projectAccessor is null.&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">projectAccessor</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="cm">/**</span>
<span class="cm">   * astah*本体のメインウィンドウに対応するJFrameを取得します。</span>
<span class="cm">   *</span>
<span class="cm">   * @return JFrame</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="n">JFrame</span> <span class="nf">getMainFrame</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">getProjectAccessor</span><span class="p">().</span><span class="na">getViewManager</span><span class="p">().</span><span class="na">getMainFrame</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="cm">/**</span>
<span class="cm">   * 現在実行しているastah*のエディションを取得します。</span>
<span class="cm">   */</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getEdition</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">getProjectAccessor</span><span class="p">().</span><span class="na">getAstahEdition</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="kd">private</span> <span class="n">IViewManager</span> <span class="nf">getViewManager</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ProjectAccessor</span> <span class="n">projectAccessor</span> <span class="o">=</span> <span class="n">getProjectAccessor</span><span class="p">();</span>
    <span class="n">IViewManager</span> <span class="n">viewManager</span> <span class="o">=</span> <span class="n">projectAccessor</span><span class="p">.</span><span class="na">getViewManager</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">viewManager</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;ViewManager is null.&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">viewManager</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">private</span> <span class="n">IModelEditorFactory</span> <span class="nf">getModelEditorFactory</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ProjectAccessor</span> <span class="n">projectAccessor</span> <span class="o">=</span> <span class="n">getProjectAccessor</span><span class="p">();</span>
    <span class="n">IModelEditorFactory</span> <span class="n">modelEditorFactory</span> <span class="o">=</span> <span class="n">projectAccessor</span><span class="p">.</span><span class="na">getModelEditorFactory</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">modelEditorFactory</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;modelEditorFactory is null.&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">modelEditorFactory</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">private</span> <span class="n">IDiagramEditorFactory</span> <span class="nf">getDiagramEditorFactory</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ProjectAccessor</span> <span class="n">projectAccessor</span> <span class="o">=</span> <span class="n">getProjectAccessor</span><span class="p">();</span>
    <span class="n">IDiagramEditorFactory</span> <span class="n">diagramEditorFactory</span> <span class="o">=</span> <span class="n">projectAccessor</span><span class="p">.</span><span class="na">getDiagramEditorFactory</span><span class="p">();</span>
    <span class="k">if</span><span class="p">(</span><span class="n">diagramEditorFactory</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;diagramEditorFactory is null.&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">diagramEditorFactory</span><span class="p">;</span>
  <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="swing">
<h2>Swingのスニペット集<a class="headerlink" href="#swing" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://terai.xrea.jp/Swing.html">Java Swingのサンプル</a></p>
</div>
<div class="section" id="id1">
<h2>メニューの拡張<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>詳細はチュートリアル、または同梱されているtutorialexampleプロジェクトを参照してください。</p>
<p>plugin.xmlの例</p>
<div class="highlight-xml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">&quot;com.change_vision.astah.ui.actionSets&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;actionSet</span>
      <span class="na">label=</span><span class="s">&quot;%action_set_label&quot;</span>
      <span class="na">visible=</span><span class="s">&quot;true&quot;</span>
      <span class="na">id=</span><span class="s">&quot;com.example.helloworld.actionSet&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;menu</span>
        <span class="na">id=</span><span class="s">&quot;helloworld&quot;</span>
        <span class="na">label=</span><span class="s">&quot;%menu_group&quot;</span>
        <span class="na">path=</span><span class="s">&quot;tool/helloworld&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;/menu&gt;</span>
      <span class="nt">&lt;action</span>
        <span class="na">label=</span><span class="s">&quot;%menu_label&quot;</span>
        <span class="na">icon=</span><span class="s">&quot;icons/sample.gif&quot;</span>
        <span class="na">class=</span><span class="s">&quot;com.example.actions.HelloWorldAction&quot;</span>
        <span class="na">tooltip=</span><span class="s">&quot;%menu_tooltip&quot;</span>
        <span class="na">menubarPath=</span><span class="s">&quot;tool/helloworld/&quot;</span>
        <span class="na">id=</span><span class="s">&quot;com.example.actions.HelloWorldAction&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;/action&gt;</span>
    <span class="nt">&lt;/actionSet&gt;</span>
  <span class="nt">&lt;/extension&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</pre></div>
</td></tr></table></div>
<p>アクションの例</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * パッケージ名は、生成したプラグインのパッケージ名よりも下に移してください。</span>
<span class="cm"> * プラグインのパッケージ名=&gt; com.example</span>
<span class="cm"> *   com.change_vision.astah.extension.plugin =&gt; X</span>
<span class="cm"> *   com.example                              =&gt; O</span>
<span class="cm"> *   com.example.internal                     =&gt; O</span>
<span class="cm"> *   learning                                 =&gt; X</span>
<span class="cm"> */</span>
<span class="kn">package</span> <span class="nn">com.example.actions</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.swing.JOptionPane</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.ui.IPluginActionDelegate</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.ui.IWindow</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloWorldAction</span> <span class="kd">implements</span> <span class="n">IPluginActionDelegate</span> <span class="p">{</span>
  <span class="kd">public</span> <span class="n">Object</span> <span class="nf">run</span><span class="p">(</span><span class="n">IWindow</span> <span class="n">window</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">UnExpectedException</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="n">JOptionPane</span><span class="p">.</span><span class="na">showMessageDialog</span><span class="p">(</span><span class="n">window</span><span class="p">.</span><span class="na">getParent</span><span class="p">(),</span> <span class="s">&quot;Hello World&quot;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">JOptionPane</span><span class="p">.</span><span class="na">showMessageDialog</span><span class="p">(</span><span class="n">window</span><span class="p">.</span><span class="na">getParent</span><span class="p">(),</span>
          <span class="s">&quot;Exception occured&quot;</span><span class="p">,</span> <span class="s">&quot;Alert&quot;</span><span class="p">,</span> <span class="n">JOptionPane</span><span class="p">.</span><span class="na">ERROR_MESSAGE</span><span class="p">);</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="n">UnExpectedException</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id2">
<h2>拡張ビューの拡張<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>詳細はチュートリアル、または同梱されているtutorialexampleプロジェクトを参照してください。</p>
<p>plugin.xmlの例</p>
<div class="highlight-xml notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;plugin&gt;</span>
  <span class="nt">&lt;extension</span> <span class="na">point=</span><span class="s">&quot;com.change_vision.astah.ui.view&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;view</span>
      <span class="na">id=</span><span class="s">&quot;com.example.internal.HelloWorldView&quot;</span>
      <span class="na">type=</span><span class="s">&quot;extraTab&quot;</span>
      <span class="na">class=</span><span class="s">&quot;com.example.internal.HelloWorldView&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/extension&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</pre></div>
</td></tr></table></div>
<p>ビューの例</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * パッケージ名は、生成したプラグインのパッケージ名よりも下に移してください。</span>
<span class="cm"> * プラグインのパッケージ名=&gt; com.example</span>
<span class="cm"> *   com.change_vision.astah.extension.plugin =&gt; X</span>
<span class="cm"> *   com.example                              =&gt; O</span>
<span class="cm"> *   com.example.internal                     =&gt; O</span>
<span class="cm"> *   learning                                 =&gt; X</span>
<span class="cm"> */</span>
<span class="kn">package</span> <span class="nn">com.example.internal</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.awt.BorderLayout</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.awt.Component</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.awt.Container</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">javax.swing.JLabel</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.swing.JPanel</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">javax.swing.JScrollPane</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.AstahAPI</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.project.ProjectAccessor</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.project.ProjectEvent</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.project.ProjectEventListener</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.ui.IPluginExtraTabView</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.ui.ISelectionListener</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloWorldView</span> <span class="kd">extends</span> <span class="n">JPanel</span>
      <span class="kd">implements</span> <span class="n">IPluginExtraTabView</span><span class="p">,</span> <span class="n">ProjectEventListener</span> <span class="p">{</span>
  <span class="kd">public</span> <span class="nf">HelloWorldView</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">initComponents</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">initComponents</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">setLayout</span><span class="p">(</span><span class="k">new</span> <span class="n">BorderLayout</span><span class="p">());</span>
    <span class="n">add</span><span class="p">(</span><span class="n">createLabelPane</span><span class="p">(),</span> <span class="n">BorderLayout</span><span class="p">.</span><span class="na">CENTER</span><span class="p">);</span>
    <span class="n">addProjectEventListener</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">addProjectEventListener</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">AstahAPI</span> <span class="n">api</span> <span class="o">=</span> <span class="n">AstahAPI</span><span class="p">.</span><span class="na">getAstahAPI</span><span class="p">();</span>
    <span class="n">ProjectAccessor</span> <span class="n">projectAccessor</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="na">getProjectAccessor</span><span class="p">();</span>
    <span class="n">projectAccessor</span><span class="p">.</span><span class="na">addProjectEventListener</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">ClassNotFoundException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">private</span> <span class="n">Container</span> <span class="nf">createLabelPane</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">JLabel</span> <span class="n">label</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JLabel</span><span class="p">(</span><span class="s">&quot;hello world&quot;</span><span class="p">);</span>
    <span class="n">JScrollPane</span> <span class="n">pane</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JScrollPane</span><span class="p">(</span><span class="n">label</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">pane</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">projectChanged</span><span class="p">(</span><span class="n">ProjectEvent</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">projectClosed</span><span class="p">(</span><span class="n">ProjectEvent</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

   <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">projectOpened</span><span class="p">(</span><span class="n">ProjectEvent</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addSelectionListener</span><span class="p">(</span><span class="n">ISelectionListener</span> <span class="n">listener</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">Component</span> <span class="nf">getComponent</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getDescription</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s">&quot;Show Hello World here&quot;</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getTitle</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s">&quot;Hello World View&quot;</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">activated</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">deactivated</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="drag-and-drop">
<h2>Drag and Drop拡張<a class="headerlink" href="#drag-and-drop" title="Permalink to this headline">¶</a></h2>
<p>同梱されているcom.change_vision.astah.extension.plugin.drag_and_drop_exampleプロジェクトを参照してください。</p>
<p>プラグインの初期化時にDropTargetListenerを追加するため、Activator#start(BundleContext context)を実装する</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">com.example</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.osgi.framework.BundleActivator</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.osgi.framework.BundleContext</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.example.internal.ClassDiagramDropExtension</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.example.internal.util.AstahAPIUtils</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.view.IDiagramViewManager</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Activator</span> <span class="kd">implements</span> <span class="n">BundleActivator</span> <span class="p">{</span>

  <span class="kd">private</span> <span class="n">AstahAPIUtils</span> <span class="n">utils</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AstahAPIUtils</span><span class="p">();</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">start</span><span class="p">(</span><span class="n">BundleContext</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ClassDiagramDropExtension</span> <span class="n">diagramDropTargetListener</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ClassDiagramDropExtension</span><span class="p">();</span>
    <span class="n">IDiagramViewManager</span> <span class="n">diagramViewManager</span> <span class="o">=</span> <span class="n">utils</span><span class="p">.</span><span class="na">getDiagramViewManager</span><span class="p">();</span>
    <span class="n">diagramViewManager</span><span class="p">.</span><span class="na">addDropTargetListener</span><span class="p">(</span><span class="n">diagramDropTargetListener</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">stop</span><span class="p">(</span><span class="n">BundleContext</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>DropTargetListenerの実装例</p>
<div class="highlight-java notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * パッケージ名は、生成したプラグインのパッケージ名よりも下に移してください。</span>
<span class="cm"> * プラグインのパッケージ名=&gt; com.example</span>
<span class="cm"> *   com.change_vision.astah.extension.plugin =&gt; X</span>
<span class="cm"> *   com.example                              =&gt; O</span>
<span class="cm"> *   com.example.internal                     =&gt; O</span>
<span class="cm"> *   learning                                 =&gt; X</span>
<span class="cm"> */</span>
<span class="kn">package</span> <span class="nn">com.example.internal</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.awt.datatransfer.DataFlavor</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.awt.datatransfer.Transferable</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.awt.dnd.DnDConstants</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.awt.dnd.DropTargetDragEvent</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.awt.dnd.DropTargetDropEvent</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.awt.dnd.DropTargetEvent</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.io.File</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Set</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.model.IClassDiagram</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.change_vision.jude.api.inf.view.DiagramDropTargetListener</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">ClassDiagramDropExtension</span> <span class="kd">extends</span> <span class="n">DiagramDropTargetListener</span> <span class="p">{</span>

  <span class="kd">public</span> <span class="nf">ClassDiagramDropExtension</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">super</span><span class="p">(</span><span class="n">IClassDiagram</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dropExternalData</span><span class="p">(</span><span class="n">DropTargetDropEvent</span> <span class="n">dtde</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">dtde</span><span class="p">.</span><span class="na">isLocalTransfer</span><span class="p">())</span> <span class="k">return</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="n">dtde</span><span class="p">.</span><span class="na">isDataFlavorSupported</span><span class="p">(</span><span class="n">DataFlavor</span><span class="p">.</span><span class="na">stringFlavor</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;ClassDiagramDropExtension.stringFlavor&quot;</span> <span class="o">+</span> <span class="n">getURLStringFromDropContent</span><span class="p">(</span><span class="n">dtde</span><span class="p">));</span>
      <span class="n">dtde</span><span class="p">.</span><span class="na">dropComplete</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">dtde</span><span class="p">.</span><span class="na">isDataFlavorSupported</span><span class="p">(</span><span class="n">DataFlavor</span><span class="p">.</span><span class="na">javaFileListFlavor</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">List</span><span class="o">&lt;</span><span class="n">File</span><span class="o">&gt;</span> <span class="n">files</span> <span class="o">=</span> <span class="n">getFilesFromDropContent</span><span class="p">(</span><span class="n">dtde</span><span class="p">);</span>
      <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;javaFileListFravor&quot;</span> <span class="o">+</span> <span class="n">files</span><span class="p">);</span>
      <span class="n">dtde</span><span class="p">.</span><span class="na">dropComplete</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="kd">private</span> <span class="n">String</span> <span class="nf">getURLStringFromDropContent</span><span class="p">(</span><span class="n">DropTargetDropEvent</span> <span class="n">dtde</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">dtde</span><span class="p">.</span><span class="na">acceptDrop</span><span class="p">(</span><span class="n">DnDConstants</span><span class="p">.</span><span class="na">ACTION_LINK</span><span class="p">);</span>
    <span class="n">Transferable</span> <span class="n">target</span> <span class="o">=</span> <span class="n">dtde</span><span class="p">.</span><span class="na">getTransferable</span><span class="p">();</span>

    <span class="n">String</span> <span class="n">urlString</span><span class="p">;</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="n">urlString</span> <span class="o">=</span> <span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="n">target</span><span class="p">.</span><span class="na">getTransferData</span><span class="p">(</span><span class="n">DataFlavor</span><span class="p">.</span><span class="na">stringFlavor</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">urlString</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">urlString</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nd">@SuppressWarnings</span><span class="p">(</span><span class="s">&quot;unchecked&quot;</span><span class="p">)</span>
  <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">File</span><span class="o">&gt;</span> <span class="nf">getFilesFromDropContent</span><span class="p">(</span><span class="n">DropTargetDropEvent</span> <span class="n">dtde</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">dtde</span><span class="p">.</span><span class="na">acceptDrop</span><span class="p">(</span><span class="n">DnDConstants</span><span class="p">.</span><span class="na">ACTION_COPY</span><span class="p">);</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">File</span><span class="o">&gt;</span> <span class="n">list</span><span class="p">;</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="n">list</span> <span class="o">=</span> <span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">File</span><span class="o">&gt;</span><span class="p">)</span> <span class="n">dtde</span><span class="p">.</span><span class="na">getTransferable</span><span class="p">().</span><span class="na">getTransferData</span><span class="p">(</span><span class="n">DataFlavor</span><span class="p">.</span><span class="na">javaFileListFlavor</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">File</span><span class="o">&gt;</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">list</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dropModels</span><span class="p">(</span><span class="n">DropTargetDropEvent</span> <span class="n">dtde</span><span class="p">,</span> <span class="n">Set</span><span class="o">&lt;?&gt;</span> <span class="n">models</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dragEnter</span><span class="p">(</span><span class="n">DropTargetDragEvent</span> <span class="n">dtde</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dragExit</span><span class="p">(</span><span class="n">DropTargetEvent</span> <span class="n">dte</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dragOver</span><span class="p">(</span><span class="n">DropTargetDragEvent</span> <span class="n">dtde</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">dropActionChanged</span><span class="p">(</span><span class="n">DropTargetDragEvent</span> <span class="n">dtde</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">astah* Plug-in 用スニペット集</a><ul>
<li><a class="reference internal" href="#astah-api">astah* API用ユーティリティ</a></li>
<li><a class="reference internal" href="#swing">Swingのスニペット集</a></li>
<li><a class="reference internal" href="#id1">メニューの拡張</a></li>
<li><a class="reference internal" href="#id2">拡張ビューの拡張</a></li>
<li><a class="reference internal" href="#drag-and-drop">Drag and Drop拡張</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="appendixB.html"
                        title="previous chapter">astah* Plug-in SDK コマンド一覧</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/snippets.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="appendixB.html" title="astah* Plug-in SDK コマンド一覧"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">astah* Plug-in 開発チュートリアル 1.2 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">astah* Plug-in 用スニペット集</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, Change Vision,inc.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.5.4.
    </div>
  </body>
</html>